{"ast":null,"code":"var _jsxFileName = \"/Users/aniruddhsinghrathore/Desktop/Mathnarrator/frontend/src/components/Chat.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const navigate = useNavigate();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const scrollRef = useRef();\n  useEffect(() => {\n    const token = localStorage.getItem('mathnarrator_token');\n    if (!token) {\n      navigate('/');\n    } else {\n      // optional: fetch user info\n      // fetch('/api/me', { headers: { Authorization: 'Bearer ' + token }})\n    }\n  }, [navigate]);\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [messages]);\n  const sendMessage = async () => {\n    const trimmed = input.trim();\n    if (!trimmed) return;\n    const newMsg = {\n      from: 'user',\n      text: trimmed\n    };\n    setMessages(prev => [...prev, newMsg]);\n    setInput('');\n    setLoading(true);\n    const token = localStorage.getItem('mathnarrator_token');\n    try {\n      const resp = await fetch('/api/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + token\n        },\n        body: JSON.stringify({\n          query: trimmed\n        })\n      });\n      const data = await resp.json();\n      const botMsg = {\n        from: 'bot',\n        text: data.reply || 'No reply'\n      };\n      setMessages(prev => [...prev, botMsg]);\n    } catch (err) {\n      setMessages(prev => [...prev, {\n        from: 'bot',\n        text: 'Network error'\n      }]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem('mathnarrator_token');\n    navigate('/');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 14\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button-outline\",\n          onClick: logout,\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-window\",\n      ref: scrollRef,\n      children: messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `msg ${m.from === 'user' ? 'user' : 'bot'}`,\n        children: m.text\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"input-row\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        value: input,\n        onChange: e => setInput(e.target.value),\n        onKeyDown: e => e.key === 'Enter' && sendMessage(),\n        placeholder: \"Type a math expression or question...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button\",\n        onClick: sendMessage,\n        disabled: loading,\n        children: loading ? \"…\" : \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 5\n  }, this);\n}\n_s(Chat, \"BSopWqhP8NmMAHJFDkJN6V+FQUI=\", false, function () {\n  return [useNavigate];\n});\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useRef","useNavigate","jsxDEV","_jsxDEV","Chat","_s","navigate","messages","setMessages","input","setInput","loading","setLoading","scrollRef","token","localStorage","getItem","current","scrollTop","scrollHeight","sendMessage","trimmed","trim","newMsg","from","text","prev","resp","fetch","method","headers","body","JSON","stringify","query","data","json","botMsg","reply","err","logout","removeItem","children","style","display","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","className","onClick","ref","map","m","i","value","onChange","e","target","onKeyDown","key","placeholder","disabled","_c","$RefreshReg$"],"sources":["/Users/aniruddhsinghrathore/Desktop/Mathnarrator/frontend/src/components/Chat.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react'\nimport { useNavigate } from 'react-router-dom'\n\nexport default function Chat(){\n  const navigate = useNavigate()\n  const [messages, setMessages] = useState([])\n  const [input, setInput] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const scrollRef = useRef()\n\n  useEffect(() => {\n    const token = localStorage.getItem('mathnarrator_token')\n    if(!token){\n      navigate('/')\n    } else {\n      // optional: fetch user info\n      // fetch('/api/me', { headers: { Authorization: 'Bearer ' + token }})\n    }\n  }, [navigate])\n\n  useEffect(() => {\n    if(scrollRef.current){\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight\n    }\n  }, [messages])\n\n  const sendMessage = async () => {\n    const trimmed = input.trim()\n    if(!trimmed) return\n    const newMsg = { from: 'user', text: trimmed }\n    setMessages(prev => [...prev, newMsg])\n    setInput('')\n    setLoading(true)\n\n    const token = localStorage.getItem('mathnarrator_token')\n    try {\n      const resp = await fetch('/api/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': 'Bearer ' + token\n        },\n        body: JSON.stringify({ query: trimmed })\n      })\n      const data = await resp.json()\n      const botMsg = { from: 'bot', text: data.reply || 'No reply' }\n      setMessages(prev => [...prev, botMsg])\n    } catch(err){\n      setMessages(prev => [...prev, { from: 'bot', text: 'Network error' }])\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('mathnarrator_token')\n    navigate('/')\n  }\n\n  return (\n    <div>\n      <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>\n        <div><strong>Chat</strong></div>\n        <div>\n          <button className=\"button-outline\" onClick={logout}>Logout</button>\n        </div>\n      </div>\n\n      <div className=\"chat-window\" ref={scrollRef}>\n        {messages.map((m, i) => (\n          <div key={i} className={`msg ${m.from === 'user' ? 'user' : 'bot'}`}>\n            {m.text}\n          </div>\n        ))}\n      </div>\n\n      <div className=\"input-row\">\n        <input\n          value={input}\n          onChange={e => setInput(e.target.value)}\n          onKeyDown={e => e.key === 'Enter' && sendMessage()}\n          placeholder=\"Type a math expression or question...\"\n        />\n        <button className=\"button\" onClick={sendMessage} disabled={loading}>\n          {loading ? \"…\" : \"Send\"}\n        </button>\n      </div>\n    </div>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}